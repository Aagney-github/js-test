<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans+Std+Light" rel='stylesheet' type='text/css'>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="./js/jquery.min.js"></script>
    <script src="./esharp.js"></script>
    <title>Simple Basic Interpreter</title>
    <style type="text/css">
        #output {
            font: 700 1.0em 'Inconsolata', 'Bitstream Vera Sans Mono', 'monospace', 'Courier New', Courier, Fixed;
            font-weight: 700;
            font-size: 1.0em;
            width: 100%;
            background-color: #000000;
            color: #00ff00
        }

        h1 {
            font-family: 'Josefin Sans Std Light', arial, serif;
            border-width: 2px;
            border-bottom: 1px solid;
        }

        body {
            margin: 10px;

            font: 400 1em 'Cantarell', Verdana, Helvetica, sans-serif;
            line-height: 1.5em;
        }

        #inputform {
            display: inline;
        }

        .inputtext {
            color: blue;
        }

        #helptext {
            border: 1px solid;
            margin: 10px;
            padding: 10px;
            background-color: #dddddd;
        }

        .example {
            border: 1px dotted;
            padding: 20px;

        }
    </style>
</head>

<body>
    <h1>Simple Web Basic</h1>
    Copyright &copy; 2010 <a href="https://yohan.es">Yohanes Nugroho</a>
    <p>This is a simple implementation of unstructured BASIC (uses line numbers) in JavaScript. You can type in your
        source code, and run it in your browser. <code>INPUT</code> statement will become HTML input form. The source
        code is <a href="main.js">here</a>.</p>
    <p>Click <a href="https://yohan.es/applications/">here</a> to see other things that I've made.</p>
    <p>Other BASIC/JavaScript projects by other people:</p>
    <ul>
        <li><a href="http://www.quitebasic.com/">Quite Basic</a>, supports preliminary graphics, doesn't support INPUT.
        </li>
        <li><a href="http://www.ngbasic.com/">ngbasic</a>, has been developed for 3 years. Very complete implementation
            (uses screen emulation instead of web forms like my implementation).</li>
        <li><a href="http://www.calormen.com/applesoft/"> AppleSoft BASIC interpter</a> in Javascript.</li>
        <li><a href="http://demos.danielflower.com/JSBasic/Default.aspx">JSBasic</a> BASIC to JavaScript translator.
        </li>
        <li><a href="https://code.google.com/p/ipplesoftbasic/">ipplesoftbasic</a> a free BASIC interpreter written
            entirely in JavaScript. It's cross-platform but is intended to specifically target the iPhone.</a></li>
        <li><a href="http://www.runbasic.com/">RunBasic</a> commercial BASIC interpreter.</li>
        <li><a href="http://eder.us/projects/jbasic/">JavaScript BASIC. It seems it doesn't work on Google
                Chrome/Safari.</li>
        <li><a href="http://stevehanov.ca/blog/index.php?id=92">qb.js</a> An implementation of QBASIC in Javascript</li>
    </ul>
    <script type="3f740b0dd8a300e3ab24496f-text/javascript">

var interpreter = new Interpreter();

function myclear()
{
	$("#outputtext").remove();
	$("div#output").append('<pre id="outputtext"></pre>');
}

const inputform =  
 '<form id="inputform"><input type="text" id="inp" name="inp">' +
 '<input type="submit" value="ok"></form>' 
;

function my_string_input(p)
{
	$("#outputtext").append(inputform);
$("#inp").focus();
    $('#inputform').submit(function() {
	var val = $("#inp").val();
       	interpreter.push_input(val);
	$("#inputform").remove();
	$("#outputtext").append('<span class="inputtext"> '+val+'</span>');
	try {
       		interpreter.resume_input();
	} catch(error) {
		alert(error);
	}
        return false;
      });

	return null;
}

function my_number_input(p)
{

	$("#outputtext").append(inputform);
$("#inp").focus();
    $('#inputform').submit(function() {
	var val = $("#inp").val();

        var nval = parseFloat(val);

        if (isNaN(nval)) {
		alert("Invalid input (numeric input expected)");
		return false;
	}

       	interpreter.push_input(parseFloat(val));
	$("#inputform").remove();
	$("#outputtext").append('<span class="inputtext"> '+val+'</span>');
	try {
       		interpreter.resume_input();
	} catch(error) {
		alert(error);
	}
       return false;
      });

	return null;
}

function myprint(text, eol)
{
	$("#outputtext").append(text);
	if (eol)
 		$("#outputtext").append("<br/>");
}



function runbasic(inp)
{
if (inp.hidecode.value==="on") {
$("#source").hide("slow");
$("#showsource").show();
}
	$("#outputtext").remove();
	$("div#output").append('<pre id="outputtext"></pre>');

	try {

		var p = new Parser(inp.sourcecode.value);
		p.parse();

		interpreter.setParser(p);
		interpreter.print_function = myprint;
		interpreter.string_input_function = my_string_input;
		interpreter.number_input_function = my_number_input;
		interpreter.clear_function = myclear;
		interpreter.interpret();
		return false;
	} catch (error) {
		alert(error);
		return false;
	}
}

    $("#outputtext").delegate("form", "submit", function(){
      alert("<p>Another paragraph!</p>");
return false;
    });

function showsource(inp)
{
$("#source").show("slow");
$("#showsource").hide();
return false;
}

function togglehelp(inp)
{
if (inp.thelp.value==="Show Help") {
$("#helptext").show();
inp.thelp.value="Hide Help";
} else {
inp.thelp.value="Show Help";
$("#helptext").hide();
}
return false;
}


$(document).ready(function() {
$("#showsource").hide();
$("#helptext").hide();
});

function copy_code(id)
{
a = $("#"+id).text();
 $("#sourcetext").val(a);
 $("#showhelptext").val("Show Help");
$("#helptext").hide();
return false;
}

</script>
    <h2>Help</h2>
    <div id="showhelp">
        <form id="showhelpform" name="help"
            onSubmit="if (!window.__cfRLUnblockHandlers) return false; return togglehelp(this);"
            data-cf-modified-3f740b0dd8a300e3ab24496f-=""><input name="thelp" type="submit" id="showhelptext"
                value="Show Help"></form>
    </div>
    <div id="helptext">
        <h3>Keywords</h3>
        <p>Although I haven't tested most of them, the following keywords should work:
            <code>IF THEN ELSE FOR TO STEP GOTO GOSUB RETURN NEXT INPUT LET CLS END PRINT DIM DATA READ REM END OR AND MOD WHILE WEND RANDOMIZE SYSTEM CLEAR</code>.
            Other keywords (<code>ON GOTO, ON GOSUB, ON ERROR, RESUME, etc</code>) are not implemented.
            <code>PRINT</code> doesn't support <code>USING</code>.
        </p>
        <h3>Functions</h3>
        <p>The following functions should work:
            <code>VAL STR$ LEFT$ RIGHT$ MID$ LEN RND INT INSTR ABS ASC CHR$ SQR STRING$ SIN COS TAN TIMER</code>
        </p>
        <h3>Test Code</h3>
        <p>Here are some code that you can run</p>
        <h4>I/O Example</h4>
        <p>Example to show how <code>INPUT</code> is displayed as HTML Form</p>
        <form name="help" onSubmit="if (!window.__cfRLUnblockHandlers) return false; return copy_code('p0');"
            data-cf-modified-3f740b0dd8a300e3ab24496f-=""><input name="cp" type="submit"
                value="Copy To Source Code Box"></form>
        <pre id="p0" class="example">10 INPUT "What is your name?", NAME$
20 INPUT "Input a number ", A
30 FOR I=1 TO A
40 PRINT "Hello "; NAME$
50 NEXT I
</pre>
        <h4>Reverse Phrase</h4>
        <p>Taken from <a href="http://glind.customer.netspace.net.au/gw-basic.html">here</a> (unmodified source).</p>
        <form name="help" onSubmit="if (!window.__cfRLUnblockHandlers) return false; return copy_code('p1a');"
            data-cf-modified-3f740b0dd8a300e3ab24496f-=""><input name="cp" type="submit"
                value="Copy To Source Code Box"></form>
        <pre id="p1a" class="example">10 REM Reverse the letters of a phrase
20 CLEAR :KEY OFF :CLS
30 INPUT &quot;What is your phrase&quot;;PHRASE$
40 PRINT :PRINT &quot;The phrase reversed: &quot;;
50 FOR LETTER = 1 TO LEN(PHRASE$)
60   PRINT LEFT$(RIGHT$(PHRASE$,LETTER),1);
70 NEXT LETTER
80 END
</pre>
        <h4>Armstrong Numbers</h4>
        <p>Taken from <a href="http://glind.customer.netspace.net.au/gw-basic.html">here</a>.</p>
        <form name="help" onSubmit="if (!window.__cfRLUnblockHandlers) return false; return copy_code('p1b');"
            data-cf-modified-3f740b0dd8a300e3ab24496f-=""><input name="cp" type="submit"
                value="Copy To Source Code Box"></form>
        <pre id="p1b" class="example">10 ' PROGRAM Armstrong Numbers
20 CLS
30 PRINT &quot;ARMSTRONG NUMBERS&quot; :PRINT
40 PRINT &quot;Program computes all Armstrong numbers in the range of 0 - 999.&quot;
50 PRINT &quot;An Armstrong number is a number such that the sum of its digits&quot;
60 PRINT &quot;raised to the third power is equal to the number itself.&quot; :PRINT
70 '
80 '   A, B, C                             the three digits
90 '   ABC, A3B3C3                         the number and its cubic sum
100 '   COUNT                              a counter
110 '
120 A=0: B=0: C=0: COUNT=0                 'initialise
130 FOR A = 0 TO 9                         'for the left most digita
140   FOR B = 0 TO 9                       'for the middle digit
150     FOR C = 0 TO 9                     'for the right most digit
160       ABC = A*100 + B*10 + C           'the number
170       A3B3C3 = A^3 + B^3 + C^3         'the sum of cubes
180       IF ABC = A3B3C3 THEN GOSUB 230   'if they are equal
190     NEXT C
200   NEXT B
210 NEXT A
220 END
230 ' Display results subroutine
240 COUNT = COUNT + 1                      'count the Armstrongs
250 PRINT &quot;Armstrong number&quot;; COUNT;&quot;: &quot;; ABC
260 RETURN

</pre>
        <h4>99 Bottles of beer</h4>
        <p>Slightly modified from <a href="http://99-bottles-of-beer.net/language-apple-1-basic-1720.html">basic version
                for apple 1 basic</a> (I changed # to &lt;&gt;).</p>
        <form name="help" onSubmit="if (!window.__cfRLUnblockHandlers) return false; return copy_code('p2');"
            data-cf-modified-3f740b0dd8a300e3ab24496f-=""><input name="cp" type="submit"
                value="Copy To Source Code Box"></form>
        <pre id="p2" class="example">1 REM A SUBSTANTIAL PART TAKEN
2 REM FROM THE BASIC EXAMPLE.
3 REM FIXED S GRAMMAR AND 
4 REM FORMATED TO FIT APPLE 1
5 REM SCREEN
6 REM
7 REM PROGRAMED ON THE APPLE 1
8 REM REPLICA BY VINCE BRIEL.
9 REM 
10 FOR X=99 TO 1 STEP -1
20 Y=X-1
30 PRINT X;&quot; BOTTLE&quot;;
40 IF X&lt;&gt;1 THEN PRINT &quot;S&quot;;
50 PRINT &quot; OF BEER ON THE WALL,&quot;
60 PRINT X;&quot; BOTTLE&quot;;
70 IF X&lt;&gt;1 THEN PRINT &quot;S&quot;;
80 PRINT &quot; OF BEER&quot;
90 PRINT &quot;TAKE ONE DOWN AND PASS IT AROUND,&quot;
100 PRINT X-1;&quot; BOTTLE&quot;;
110 IF Y&lt;&gt;1 THEN PRINT &quot;S&quot;;
120 PRINT &quot; OF BEER ON THE WALL&quot;
130 PRINT &quot;&quot;
140 NEXT X
150 END
</pre>
    </div>
    <h2>Source Code</h2>
    <div id="showsource">
        <form name="basic" onSubmit="if (!window.__cfRLUnblockHandlers) return false; return showsource(this);"
            data-cf-modified-3f740b0dd8a300e3ab24496f-="">
            <span><input name="show" type="submit" value="Show code"> </span>
        </form>
    </div>
    <div id="source" class="source">
        <form name="basic" onSubmit="if (!window.__cfRLUnblockHandlers) return false; return runbasic(this);"
            data-cf-modified-3f740b0dd8a300e3ab24496f-="">
            <textarea id="sourcetext" name="sourcecode" rows="10" cols="80">
10 INPUT "What is your name?", NAME$
20 INPUT "Input a number ", A
30 FOR I=1 TO A
40 PRINT "Hello "; NAME$
50 NEXT I
</textarea><br />
            <span id="execute">
                <input checked type="checkbox" name="hidecode">Hide source code while executing
                <input name="run" type="submit" value="Execute"> </span>
        </form>
    </div>
    <h2>Execution result</h2>
    <div class="output" id="output">
        <pre id="outputtext"></pre>
    </div>
    <script src="https://ajax.cloudflare.com/cdn-cgi/scripts/7089c43e/cloudflare-static/rocket-loader.min.js"
        data-cf-settings="3f740b0dd8a300e3ab24496f-|49" defer=""></script>
</body>

</html>